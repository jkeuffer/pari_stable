Function: ellap
Section: elliptic_curves
C-Name: ellap
Prototype: GG
Help: ellap(E,p): computes a_p for the elliptic curve E using
 Shanks-Mestre's method. Assume the equation is minimal at p.
Doc: computes the trace of Frobenius $a_p$ for the elliptic curve $E$ and the
 prime number $p$. This is defined by the equation $\#E(\F_p) = p+1 - a_p$,
 where $\#E(\F_p)$ stands for the number of points of the curve $E$ over the
 finite field $\F_p$. If $E/\F_p$ has CM by a principal imaginary quadratic
 order we use an explicit formula (involving essentially Kronecker symbols and
 Cornacchia's algorithm, hence very fast: $O(\log p)^2$). Otherwise, we use
 Shanks-Mestre's baby-step/giant-step method, which runs in time $O(p^{1/4})$
 using $O(p^{1/4})$ storage, hence becomes unreasonable when $p$ has about
 30~digits. If the \tet{seadata} package is installed, the \tet{SEA} algorithm
 becomes available and primes of the order of 200~digits become feasible.

 No checking is done that $p$ is indeed prime. $E$ must be a \var{smallell} as
 output by \kbd{ellinit}, defined over $\Q$, $\F_p$ or $\Q_p$. $E$ must be
 given by a Weierstrass equation \emph{minimal} at $p$.
